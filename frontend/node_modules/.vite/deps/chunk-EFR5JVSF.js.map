{
  "version": 3,
  "sources": ["../../highlight.js/lib/languages/accesslog.js"],
  "sourcesContent": ["/**\r\n * @param {string} value\r\n * @returns {RegExp}\r\n * */\r\n\r\n/**\r\n * @param {RegExp | string } re\r\n * @returns {string}\r\n */\r\nfunction source(re) {\r\n  if (!re) return null;\r\n  if (typeof re === \"string\") return re;\r\n\r\n  return re.source;\r\n}\r\n\r\n/**\r\n * @param {...(RegExp | string) } args\r\n * @returns {string}\r\n */\r\nfunction concat(...args) {\r\n  const joined = args.map((x) => source(x)).join(\"\");\r\n  return joined;\r\n}\r\n\r\n/**\r\n * Any of the passed expresssions may match\r\n *\r\n * Creates a huge this | this | that | that match\r\n * @param {(RegExp | string)[] } args\r\n * @returns {string}\r\n */\r\nfunction either(...args) {\r\n  const joined = '(' + args.map((x) => source(x)).join(\"|\") + \")\";\r\n  return joined;\r\n}\r\n\r\n/*\r\n Language: Apache Access Log\r\n Author: Oleg Efimov <efimovov@gmail.com>\r\n Description: Apache/Nginx Access Logs\r\n Website: https://httpd.apache.org/docs/2.4/logs.html#accesslog\r\n Audit: 2020\r\n */\r\n\r\n/** @type LanguageFn */\r\nfunction accesslog(_hljs) {\r\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods\r\n  const HTTP_VERBS = [\r\n    \"GET\",\r\n    \"POST\",\r\n    \"HEAD\",\r\n    \"PUT\",\r\n    \"DELETE\",\r\n    \"CONNECT\",\r\n    \"OPTIONS\",\r\n    \"PATCH\",\r\n    \"TRACE\"\r\n  ];\r\n  return {\r\n    name: 'Apache Access Log',\r\n    contains: [\r\n      // IP\r\n      {\r\n        className: 'number',\r\n        begin: /^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b/,\r\n        relevance: 5\r\n      },\r\n      // Other numbers\r\n      {\r\n        className: 'number',\r\n        begin: /\\b\\d+\\b/,\r\n        relevance: 0\r\n      },\r\n      // Requests\r\n      {\r\n        className: 'string',\r\n        begin: concat(/\"/, either(...HTTP_VERBS)),\r\n        end: /\"/,\r\n        keywords: HTTP_VERBS,\r\n        illegal: /\\n/,\r\n        relevance: 5,\r\n        contains: [\r\n          {\r\n            begin: /HTTP\\/[12]\\.\\d'/,\r\n            relevance: 5\r\n          }\r\n        ]\r\n      },\r\n      // Dates\r\n      {\r\n        className: 'string',\r\n        // dates must have a certain length, this prevents matching\r\n        // simple array accesses a[123] and [] and other common patterns\r\n        // found in other languages\r\n        begin: /\\[\\d[^\\]\\n]{8,}\\]/,\r\n        illegal: /\\n/,\r\n        relevance: 1\r\n      },\r\n      {\r\n        className: 'string',\r\n        begin: /\\[/,\r\n        end: /\\]/,\r\n        illegal: /\\n/,\r\n        relevance: 0\r\n      },\r\n      // User agent / relevance boost\r\n      {\r\n        className: 'string',\r\n        begin: /\"Mozilla\\/\\d\\.\\d \\(/,\r\n        end: /\"/,\r\n        illegal: /\\n/,\r\n        relevance: 3\r\n      },\r\n      // Strings\r\n      {\r\n        className: 'string',\r\n        begin: /\"/,\r\n        end: /\"/,\r\n        illegal: /\\n/,\r\n        relevance: 0\r\n      }\r\n    ]\r\n  };\r\n}\r\n\r\nmodule.exports = accesslog;\r\n"],
  "mappings": ";;;;;AAAA;AAAA;AASA,aAAS,OAAO,IAAI;AAClB,UAAI,CAAC;AAAI,eAAO;AAChB,UAAI,OAAO,OAAO;AAAU,eAAO;AAEnC,aAAO,GAAG;AAAA,IACZ;AAMA,aAAS,UAAU,MAAM;AACvB,YAAM,SAAS,KAAK,IAAI,CAAC,MAAM,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE;AACjD,aAAO;AAAA,IACT;AASA,aAAS,UAAU,MAAM;AACvB,YAAM,SAAS,MAAM,KAAK,IAAI,CAAC,MAAM,OAAO,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI;AAC5D,aAAO;AAAA,IACT;AAWA,aAAS,UAAU,OAAO;AAExB,YAAM,aAAa;AAAA,QACjB;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,UAAU;AAAA;AAAA,UAER;AAAA,YACE,WAAW;AAAA,YACX,OAAO;AAAA,YACP,WAAW;AAAA,UACb;AAAA;AAAA,UAEA;AAAA,YACE,WAAW;AAAA,YACX,OAAO;AAAA,YACP,WAAW;AAAA,UACb;AAAA;AAAA,UAEA;AAAA,YACE,WAAW;AAAA,YACX,OAAO,OAAO,KAAK,OAAO,GAAG,UAAU,CAAC;AAAA,YACxC,KAAK;AAAA,YACL,UAAU;AAAA,YACV,SAAS;AAAA,YACT,WAAW;AAAA,YACX,UAAU;AAAA,cACR;AAAA,gBACE,OAAO;AAAA,gBACP,WAAW;AAAA,cACb;AAAA,YACF;AAAA,UACF;AAAA;AAAA,UAEA;AAAA,YACE,WAAW;AAAA;AAAA;AAAA;AAAA,YAIX,OAAO;AAAA,YACP,SAAS;AAAA,YACT,WAAW;AAAA,UACb;AAAA,UACA;AAAA,YACE,WAAW;AAAA,YACX,OAAO;AAAA,YACP,KAAK;AAAA,YACL,SAAS;AAAA,YACT,WAAW;AAAA,UACb;AAAA;AAAA,UAEA;AAAA,YACE,WAAW;AAAA,YACX,OAAO;AAAA,YACP,KAAK;AAAA,YACL,SAAS;AAAA,YACT,WAAW;AAAA,UACb;AAAA;AAAA,UAEA;AAAA,YACE,WAAW;AAAA,YACX,OAAO;AAAA,YACP,KAAK;AAAA,YACL,SAAS;AAAA,YACT,WAAW;AAAA,UACb;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,WAAO,UAAU;AAAA;AAAA;",
  "names": []
}
